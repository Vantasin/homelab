[![Ansible Role](https://img.shields.io/badge/Ansible-Role-blue?logo=ansible)](https://docs.ansible.com/)
[![License: MIT](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Status: Production Ready](https://img.shields.io/badge/status-Production%20Ready-success)]()
[![Platform: Raspberry Pi 5](https://img.shields.io/badge/platform-Raspberry%20Pi-lightgrey)]()
![Status](https://img.shields.io/badge/status-stable-brightgreen)

# raspberry‑pi

Ansible automation for provisioning and managing Raspberry Pi–based home servers and related infrastructure.

---

## 📑 Table of Contents

1. [Prerequisites](#prerequisites)  
2. [Installation](#installation)  
3. [Repository Layout](#repository-layout)  
4. [Usage](#usage)  
5. [Configuration](#configuration)  
6. [Key Roles](#key-roles)  
7. [Contributing](#contributing)  
8. [License](#license)  
9. [Author & Maintenance](#author--maintenance)  

---

## 📋 Prerequisites

- **Control Machine**  
  - Python 3 (with `pip`)  
  - Ansible 2.9+  
- **Managed Nodes**  
  - Raspberry Pi OS Lite (or Debian/Ubuntu)  
  - SSH access with a user able to `become` (sudo)  

---

## ⚙️ Installation

1. **Clone the repo**  
   ```bash
   git clone https://github.com/Vantasin/homelab.git
   cd homelab
   ```
2. **Install role requirements**  
   ```bash
   ansible-galaxy install -r requirements.yml
   ```
3. **Configure Vault Password**  
   - Store your vault password in `vault_pass.txt` (git‑ignored).  
   - Sensitive variables live in `vault.txt`.  

---

## 🗂 Repository Layout

```
raspberry-pi/
├── ansible.cfg           # Global Ansible config
├── inventories/          # Hosts and group vars
├── playbooks/            # site.yml, test.yml
├── roles/                # packages, zfs, docker, cron, etc.
├── requirements.yml      # Galaxy roles & collections
├── LICENSE               # MIT License
└── README.md             # This file
```

_For full details see [`codebase_summary.txt`](codebase_summary.txt) generated by `summarize_codebase.sh`._  

---

## 🚀 Usage

- **Full deployment**  
  ```bash
  ansible-playbook -i inventories/hosts.yml playbooks/site.yml \
    --vault-password-file vault_pass.txt
  ```
- **Run specific tags**  
  ```bash
  ansible-playbook ... --tags zfs,cron
  ```
- **Test ZFS only**  
  ```bash
  ansible-playbook -i inventories/hosts.yml playbooks/test.yml
  ```

---

## 🔧 Configuration

- **Inventory** — `inventories/hosts.yml`, with overrides in `group_vars/` & `host_vars/`.  
- **Global vars** — `inventories/group_vars/all.yml` (timezone, Python interpreter, etc.).  
- **Vault** — secure sensitive data in `vault.txt`; reference via `vars_files:`.  

---

## ✨ Key Roles

- **packages** — common packages (`git`, `htop`, `lazydocker`, …)  
- **zfs** — detect & provision `tank` mirror pool, compression, ARC limits, atime off  
- **docker**, **docker_compose** — Docker engine & Compose stacks (Nextcloud, Joplin, Immich…)  
- **cron** — custom scripts for APT, ZFS snapshots/scrubs, reboot checks; logrotate; email via `msmtp`  
- **borgbackup** — Borg repo initialization & backup scheduling  
- **samba_timemachine** — Samba + Avahi for networked Apple Time Machine  
- **msmtp**, **tailscale**, **oh-my-zsh**, **nano**, **scripts**, …

Each role has its own `README.md`, `defaults/main.yml`, and `meta/main.yml` for details.

---

## 🤝 Contributing

1. Fork → 2. `git checkout -b feature/your-feature` → 3. Commit & push → 4. Open PR  
2️⃣ Follow Ansible best practices: idempotent tasks, clear vars, descriptive commits.

---

## 📄 License

This project is licensed under MIT. See [LICENSE](LICENSE) for details.

---

## 🙋 Author & Maintenance

Developed and managed by **Vantasin**.  
*Built with ♥️ and maintained as “raspberry-pi” for reliable home‑lab infrastructure.*  
```
