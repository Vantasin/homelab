[![Ansible Role](https://img.shields.io/badge/Ansible-Role-blue?logo=ansible)](https://docs.ansible.com/)
[![License: MIT](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Status: Production Ready](https://img.shields.io/badge/status-Production%20Ready-success)]()
[![Platform: Raspberry Pi 5](https://img.shields.io/badge/platform-Raspberry%20Pi-lightgrey)]()
![Status](https://img.shields.io/badge/status-stable-brightgreen)

# raspberryâ€‘pi

Ansible automation for provisioning and managing RaspberryÂ Piâ€“based home servers and related infrastructure.

---

## ğŸ“‘ Table of Contents

1. [Prerequisites](#prerequisites)  
2. [Installation](#installation)  
3. [Repository Layout](#repository-layout)  
4. [Usage](#usage)  
5. [Configuration](#configuration)  
6. [Key Roles](#key-roles)  
7. [Contributing](#contributing)  
8. [License](#license)  
9. [Author & Maintenance](#author--maintenance)  

---

## ğŸ“‹ Prerequisites

- **Control Machine**  
  - PythonÂ 3 (with `pip`)  
  - AnsibleÂ 2.9+  
- **Managed Nodes**  
  - RaspberryÂ Pi OS Lite (or Debian/Ubuntu)  
  - SSH access with a user able to `become` (sudo)  

---

## âš™ï¸ Installation

1. **Clone the repo**  
   ```bash
   git clone https://github.com/Vantasin/homelab.git
   cd homelab
   ```
2. **Install role requirements**  
   ```bash
   ansible-galaxy install -r requirements.yml
   ```
3. **Configure Vault Password**  
   - Store your vault password in `vault_pass.txt` (gitâ€‘ignored).  
   - Sensitive variables live in `vault.txt`.  

---

## ğŸ—‚ Repository Layout

```
raspberry-pi/
â”œâ”€â”€ ansible.cfg           # Global Ansible config
â”œâ”€â”€ inventories/          # Hosts and group vars
â”œâ”€â”€ playbooks/            # site.yml, test.yml
â”œâ”€â”€ roles/                # packages, zfs, docker, cron, etc.
â”œâ”€â”€ requirements.yml      # Galaxy roles & collections
â”œâ”€â”€ LICENSE               # MIT License
â””â”€â”€ README.md             # This file
```

_For full details see [`codebase_summary.txt`](codebase_summary.txt) generated by `summarize_codebase.sh`._  

---

## ğŸš€ Usage

- **Full deployment**  
  ```bash
  ansible-playbook -i inventories/hosts.yml playbooks/site.yml \
    --vault-password-file vault_pass.txt
  ```
- **Run specific tags**  
  ```bash
  ansible-playbook ... --tags zfs,cron
  ```
- **Test ZFS only**  
  ```bash
  ansible-playbook -i inventories/hosts.yml playbooks/test.yml
  ```

---

## ğŸ”§ Configuration

- **Inventory** â€” `inventories/hosts.yml`, with overrides in `group_vars/` & `host_vars/`.  
- **Global vars** â€” `inventories/group_vars/all.yml` (timezone, Python interpreter, etc.).  
- **Vault** â€” secure sensitive data in `vault.txt`; reference via `vars_files:`.  

---

## âœ¨ Key Roles

- **packages** â€” common packages (`git`, `htop`, `lazydocker`, â€¦)  
- **zfs** â€” detect & provision `tank` mirror pool, compression, ARC limits, atime off  
- **docker**, **docker_compose** â€” Docker engine & Compose stacks (Nextcloud, Joplin, Immichâ€¦)  
- **cron** â€” custom scripts for APT, ZFS snapshots/scrubs, reboot checks; logrotate; email via `msmtp`  
- **borgbackup** â€” Borg repo initialization & backup scheduling  
- **samba_timemachine** â€” Samba + Avahi for networked Apple Time Machine  
- **msmtp**, **tailscale**, **oh-my-zsh**, **nano**, **scripts**, â€¦

Each role has its own `README.md`, `defaults/main.yml`, and `meta/main.yml` for details.

---

## ğŸ¤ Contributing

1. Fork â†’ 2. `git checkout -b feature/your-feature` â†’ 3. Commit & push â†’ 4. Open PR  
2ï¸âƒ£ Follow Ansible best practices: idempotent tasks, clear vars, descriptive commits.

---

## ğŸ“„ License

This project is licensed under MIT. See [LICENSE](LICENSE) for details.

---

## ğŸ™‹ Author & Maintenance

Developed and managed by **Vantasin**.  
*Built with â™¥ï¸ and maintained as â€œraspberry-piâ€ for reliable homeâ€‘lab infrastructure.*  
```
